<%= content_for :head do %>
<%= stylesheet_link_tag 'chosen_v1.4.0/chosen.min.css', 'data-turbolinks-track' => true %>
<%= stylesheet_link_tag 'bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.css', 'data-turbolinks-track' => true %>
<%= stylesheet_link_tag 'bootstrap-datepicker/dist/css/bootstrap-datepicker3.css', 'data-turbolinks-track' => true %>
<% end %>

<%= form_for(@risk_profile) do |f| %>
<% if @risk_profile.errors.any? %>
<div id="error_explanation">
  <h2><%= pluralize(@risk_profile.errors.count, "error") %> prohibited this risk_profile from being saved:</h2>

  <ul>
    <% @risk_profile.errors.full_messages.each do |message| %>
    <li><%= message %></li>
    <% end %>
  </ul>
</div>
<% end %>

<div class="row">
  <div class="col-sm-6">
    <div class="row">
      <div class="col-sm-12">
        <div class="panel mb25">
          <div class="panel-heading border">
            Location
          </div>
          <div class="panel-body">
            <div class="row">
              <div class="col-xs-12 mb25">
                <p>State</p>
                <%= f.select :state, options_for_select(us_states), {}, { class:'chosen', style:'width:100%;', 'data-placeholder':'State' } %>
              </div>

              <div class="col-xs-12 mb25">
                <p>County</p>
                <%= f.select :county, options_for_select(us_counties), {}, { class:'chosen', style:'width:100%;', 'data-placeholder':'County' } %>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-sm-12">
        <div class="panel mb25">
          <div class="panel-heading border">
            Coverage Period
          </div>
          <div class="panel-body m15">
            <div class="col-xs-12 coverage-period">
              <div class="input-prepend input-group">
                <span class="add-on input-group-addon">
                  Effective Date
                  <i class="fa fa-calendar"></i>
                </span>
                <%= f.text_field :effective, class:'form-control', 'data-provide':'datepicker' %>
              </div>
            </div>

            <div class="col-xs-12 coverage-period">
              <div class="input-prepend input-group">
                <span class="add-on input-group-addon">
                  Retroactive Date
                  <i class="fa fa-calendar-o"></i>
                </span>
                <%= f.text_field :retro, class:'form-control', 'data-provide':'datepicker' %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-sm-6">
    <div class="panel mb25">
      <div class="panel-heading border">
        Exposures
      </div>
      <div class="panel-body">
        <div class="row">
          <div class="col-xs-12 mb25">
            <p>Name</p>
            <span class="col-xs-10">
              <%= f.text_field :name, class:'form-control', placeholder:'John Doe' %>
            </span>
            <span class="col-xs-2">
              <%= select_tag :suffix, options_for_select([ "M.D.", "D.O." ]), class:'form-control btn btn-info' %>
            </span>
          </div>

          <div class="col-xs-12 mb25">
            <p>Specialty</p>
            <%= f.select :specialty, options_for_select(@spec_names), {}, { class:'chosen', style:'width:100%;', 'data-placeholder':'Specialty' } %>
          </div>

          <div class="col-xs-12 mb25">
            <p>Allied Staff</p>
            <%- AlliedRate.all.each do |ar| %>
            <div class="row">
              <div class="col-xs-5">
                <%= ar.elements.join(", ") %>
              </div>
              <div class="col-xs-7">
                <div class="input-group input-group-lg mb25">
                  <%= f.text_field ar.category.downcase.to_sym, class:'form-control input-lg spinner-ar' %>
                </div>
              </div>
            </div>
            <% end -%>
            <%- if AlliedRate.all.empty? %>
              <p>No Allied Staff Rates.</p>
            <% end -%>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row mb25">
  <div class="col-sm-12">
    <div class="panel mb25">
      <div class="panel-heading border">
        Liabilities
      </div>
      <div class="panel-body">
        <div class="row">
          <div class="col-xs-6">
            <div class="col-xs-3">
              Deductible
            </div>
            <div class="col-xs-9">
              <div class="input-group input-group-lg mb25">
                <%= f.text_field :deductible, class:'form-control input-lg spinner-ded' %>
              </div>
            </div>
          </div>
          <div class="col-xs-3">
            <p>Entity Coverage?</p>
            <label class="switch mb15">
              <%= f.check_box :entity, checked:true %>
              <span>
                <i class="handle"></i>
              </span>
            </label>
          </div>
        </div>

        <div class="row">
          <div class="col-xs-6">
            <p>Limit</p>
            <%= f.select :limit, options_for_select(@limits), {}, { class:'chosen', style:'width:100%;', 'data-placeholder':'Limit' } %>
          </div>

          <div class="col-xs-6">
            <p>NAS Limit</p>
            <%= f.select :limit_nas, options_for_select(@nases), {include_blank: 'Forego NAS'}, { class:'chosen', style:'width:100%;', 'data-placeholder':'NAS Limit' } %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="actions text-center">
  <%= f.submit class:'btn btn-success btn-lg' %>
</div>

<% end %>

  <%= content_for :js_includes do %>
  <%= javascript_include_tag 'chosen_v1.4.0/chosen.jquery.min.js', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.js', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'bootstrap-datepicker/js/bootstrap-datepicker.js', 'data-turbolinks-track' => true %>

  <script>
  $('document').ready(function() {
    'use strict';
    $('.chosen').chosen();
  });

  $('.spinner-ar').TouchSpin({
    initval: 0,
    buttondown_class: 'btn btn-success',
    buttonup_class: 'btn btn-success'
  });
  $('.spinner-ded').TouchSpin({
    initval: 0,
    step: 5000,
    max: "<%= DedFactor.maximum(:deductible) %>",
    buttondown_class: 'btn btn-info',
    buttonup_class: 'btn btn-info'
  });
  </script>
  <% end %>
